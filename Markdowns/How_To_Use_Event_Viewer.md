#### How to Use the EventViewer In Powershell ####

- `EventViewer` is a `component of Windows NT line of Operating System` which allow the `admin as well as user to view the logs` on `local or remote machine`
- it allow us to `Monitor the Event` in your system
- its `logs` info about `Program/Security/System Event on your computer`
- we can use the `Event Viewer` to `view and manage` the `event logs` and also handles the `info about software and hardware problem`
- We can access the `Event Viewer` by clicking on the `Computer Management` &rarr; `Event Vieewer` &rarr; &rarr; `Event Viewer`
- we can also open the `EventViewer` as `win+R----> Eventvwr`

- There  are different type of Logs available in `EventViewer`
  - System Log
  - Applicvation Log
  - Security Log

##### System Log-

- `System Log` record and log the event `logged by the windows system components` 
- ex:- `Failure in Driver or any other system component` logged as the `System Log`

##### Application Log :-

- The `Application Log` record the `event` logged by the `program`
- in case of an `DataBase Error` that `Database Application` will log the info the `Application Log`

##### Security Log :-

- The Security Log records the `Security Events` such as `valid or invalid logon attempts`
- it also log the info about the `resources` such as `creating/opening/deleting files or other objects`
- the `Security Log` can fetch the possible `Security Breach` for the system
- we can see the Security Log if we are the `admin` for the computer

- for each type of the Logging we have `different type of Log Events `Info Such as 
  - Error :- A significant problem,such as loss of dataor loss of functionality
  - Warning :- An Event that might not be Significant,but might indicate  a failure program
  - Information :- An Event which is sucessful of an `application or driver or service`
  - Succeess Audit :- An Audited Security Access Which is Successful
  - Failure Audit :- An Audited Security Attempt but that got failed 

### Event Viewer Page ####

- we have few different type while we open the `Event Viewer` such as `Custom Views` amd `Windows Log`  and `Application and Service Log` and `Subscription`
- if we open the `Windows Log`  which comes by default with the windows  , here if we open it then we can see the `Application/Security/System/SetUp` logs inside of it 
- Each `Application/Security/System/SetUp` are dedicated to log a `particular` type of `Event Logs`
- we can also see the detail info by clicking on the `Event Log` and then see it in `General` Page
- we can also save the `Event Log` into a file system by using it as `Save Selected Events`
- by using the `Attach Task to Event` by using this option we can associate the `Task` to the `Particular Event` occur
- we can save the info of the `Event Viewer Logs` as the `.evtx` extension

- By using the `Event Viewer` if we want to Access the `Remote Computer Logs` then we can do that by using the `connect to another computer`  by clicking on the `Event Viewer` option
- we can read and write the `Event Logs` using the `Powershell` as well 


#### How to Access EventViewer Uisng Powershell #####

- we can access the `Event Viewer Logs` by using the  `Get-EventLog` cmdlet
- By default its `ask for the logname` when to try to execute the `Get-EventLog` as thats the `Mandetory Parameter`
- we can  see all the `Log` by using the `-List` switch to the `Get-EventLog` cmdlet as below `Get-EventLog -List` this will show all the `EventLogs` thats been available 
- this `Get-EventLog -List` will show the exact same info that we can see in the `Event-Viewer` Page
- we can see a particualr Loginfo by passing the `-LogName` as the `Application` so that we can see only `Applicatiopn Logs`
- we can write that as the `Get-EventLog -LogName "Application" ` this will show all the `Application Logs` out in here
- we can also get the logs of a particular Source by using `-Source ` switch as below 
  
  ```
    # By using the `Source` flag we can define a definite Source of the Application in here
    Write-Output $(Get-EventLog -LogName "Application" -Source "VSS")

  ```
- we can fetch the `Newest` New Logs that are getting Generated by using the `-Newest` flag as below 

    ```
        #here using the `Newest` flag to fetch the latest Application logs
        Write-=Output $(Get-EventLog -LogName "Newest" -Source "VSS" -Newest 5)
        #here it will display the `Latest 5 logs` with the Apllication log whose name is of `VSS`

    ```

- we can also fetch a Particular Type Of Application By using it `EntryPoint` flag as below it can be of `Error/Information` etc

    ```
        Write-Output $(Get-EventLog -LogName "Application" -Source "VSS" -EntryPoint Error -Newest 5 )
        #this will only show the Info about the Error that caused due to the  VSS Application for the Latest 5 
    ```
- we can also use `datetime` to capture the `Log` for a particular duration as below using the `After` and `Before` flag as below

    ```
        $current-time=Get-Date # this will provide the Date in this case
        $prev-time=$current-time.AddHours(-1)
        #this will provide the Date and Time for the Previous Application over here
        we can also get the Log Using ther `Before` and `After` flag as below 
        Write-Output $(Get-EventLog -LogName "Application" -Source "VSS" -Newest 5 -EntryType "Error" -Before $prev-time -After $current-time )
        # this will generate the Log Happend between the Time and Previous 1 Hr
        #same Like AddHours() we can use the AddDays() and AddMinutes() as well

    ```

- we can export the result into the `HTML` by using the `ConvertTo-HTML` cmdlet and additionally we can also use the `Property` cmdlet only found few info not all
- we can write it as below 

    ```
        $current-time=Get-Date # this will provide the Date in this case
        $prev-time=$current-time.AddHours(-1)
        #this will provide the Date and Time for the Previous Application over here
        we can also get the Log Using ther `Before` and `After` flag as below 
        Get-EventLog -LogName "Application" -Source "VSS" -Newest 5 -EntryType "Error" -Before $prev-time -After $current-time |
        ConvertTo-HTML -Property eventId,Source,Message | Out-File "index.html"  
        #using this we can be able to get the info in this case as well
    ```

- we can also use the info with the `Select-Object` and `Where-Object` as well in this case

    ```
        #piping it aligned with the `Select-Object` in this case
        Write-Output $(Get-EventLog -LogName "Newest" -Source "VSS" -Newest 5 | Select-Object -First 5)
        # we can also use the information as `Where-Object` to fetch a Particular eventId as below 
        Write-Output $(Get-EventLog -LogName "Newest" -Source "VSS" | Where-Object {$_.eventID -eq 8422 }
        # using this also we can achieve the result as well

    ```

- we can also mention the `-ComputerName` with the `<hostname of the computer>` to fetch the `logs` for the same as below 
  
  ```
        $host_name=[System.Net.DNS]::GetHostByName('').HostName
        #piping it aligned with the `Select-Object` and Providing the `-ComputerName` flag to it  in this case
        Write-Output $(Get-EventLog -LogName "Application" -Source "VSS" -Newest 5 -ComputerName $host_name | Select-Object -First 5)
  ```


- we can use the `Get-WmiObject` as well to get the info about the `EventViewer` as well 


##### How to Write to the Event Viewer using PowerShell #####

- we can `register` our logs onto the `Existing LogName`
- we can write to a `existing Log` by using the `New-EventLog` cmdlet and providing the same `-LogName` which exists such as `Application`
- while writing to the Existing Log then we can use it as `-Source <your source name which can be any string>`
- we can see all the existing application by using the command as `Get-EventLog -List` command
- we can also write to the Estisting `LogName` we are using the `Write-EventLog` cmdlet 
- also we need to provide other parameter as well which are of 
  - `-Source` Flag with the name of the Script as  `"<any str>"`
  - `-EntryType` to define the `What type of log we want to use in this case`
  - `EventId` with the `EventId` we want to produce
  - `-Message` what `message we want to Publish `

    ```
        #this will just create a log but not going to Write to the Event-Viewer
        New-EventLog -LogName "Application" -Source "My Script"
        #in order to Write to the Event-Viewer we need to use it as 
        Write-EventLog -LogName "Application" -Source "my-script" -EntryType Error -EventId 1 -Message "<what message we want to Provide in here>"

    ```


- In order to Write to a New-Event Log then we need to use it as below 
- if we want to create a New LogName then we have to Provide the `MessageResourceFile` cmdlet
- this `MessageResourceFile` will take a `.dll` file in order to create the `New LogName`
- we can create summy `.dll` file and point that path using the `MessageResourceFile` cmdlet path 
- this will create the `New LogName` in the `EventLog` which can be validated by using the `Get-EventLog -List`
- but if we want to Write to the `Newly created LogName` then we can use that by using the parameter as below 
- - also we need to provide other parameter as well which are of 
  - `-Source` Flag with the name of the Script as  `"<any str>"`
  - `-EntryType` to define the `What type of log we want to use in this case`
  - `EventId` with the `EventId` we want to produce
  - `-Message` what `message we want to Publish `

- the code for that can be written as below 

    ```
        #here this will create a NewLogName by using the `.dll` file against the `MessageResourceFile` path
        New-EventLog -LogName "<name of your Log>" -Source "<name of event that been going to the LogName>" -MessageResourceFile "<path of the dll file>"
        #here also wif we want to Write Message to the New LogName we have to use the `Write-EventLog` cmdlet as below
         Write-EventLog -LogName "<name of your Log>" -Source "<name of event that been going to the LogName>" -EntryType Error -EventId 1 -Message "<what message we want to Provide in here>"

    ```

